<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selectra - Checklist avec Historique des Ventes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <div class="checklist-app">
            
            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('checklist')" id="tab-checklist">
                    üìã Checklist
                    <span class="tab-badge" id="checklist-badge">0%</span>
                </button>
                <button class="nav-tab" onclick="switchTab('history')" id="tab-history">
                    üìä Historique
                    <span class="tab-badge success" id="history-badge">0</span>
                </button>
            </div>

            <!-- TAB 1: CHECKLIST -->
            <div id="tab-checklist-content" class="tab-content active">
                
                <!-- Header avec logo et timer -->
                <div class="app-header">
                    <div class="logo-section">
                        <div class="logo-icon">‚ö°</div>
                        <div class="logo-text">
                            <div class="logo-title">SELECTRA</div>
                            <div class="logo-subtitle">Checklist + Historique</div>
                        </div>
                    </div>
                    
                    <div class="timer-section">
                        <div class="timer-display">
                            <span class="timer-icon">‚è±Ô∏è</span>
                            <span class="timer-text" id="call-timer">00:00</span>
                        </div>
                        <button class="start-call-btn" id="start-call" onclick="startCall()">
                            üìû D√©marrer
                        </button>
                    </div>
                </div>

                <!-- Section Informations Client - Organisation am√©lior√©e -->
                <div class="section">
                    <div class="section-header">
                        <h3 class="section-title">üìù INFORMATIONS CLIENT</h3>
                        <div class="section-counter" id="client-counter">0/8</div>
                    </div>
                    
                    <div class="client-fields">
                        <!-- Sous-section Identit√© -->
                        <div class="client-subsection">
                            <div class="client-subsection-header">
                                <span class="subsection-icon">üë§</span>
                                <span class="subsection-title">Identit√©</span>
                                <div class="subsection-progress" id="identite-progress">0/2</div>
                            </div>
                            <div class="field-row">
                                <div class="field-group">
                                    <label for="client-nom">Nom *</label>
                                    <input type="text" id="client-nom" class="field-input required" placeholder="Nom du client" data-section="client" data-subsection="identite">
                                </div>
                                <div class="field-group">
                                    <label for="client-prenom">Pr√©nom *</label>
                                    <input type="text" id="client-prenom" class="field-input required" placeholder="Pr√©nom du client" data-section="client" data-subsection="identite">
                                </div>
                            </div>
                        </div>

                        <!-- Sous-section Contact -->
                        <div class="client-subsection">
                            <div class="client-subsection-header">
                                <span class="subsection-icon">üìû</span>
                                <span class="subsection-title">Contact</span>
                                <div class="subsection-progress" id="contact-progress">0/3</div>
                            </div>
                            <div class="field-group">
                                <label for="client-adresse">Adresse compl√®te *</label>
                                <textarea id="client-adresse" class="field-textarea required" rows="2" placeholder="Adresse compl√®te, Code postal, Ville" data-section="client" data-subsection="contact"></textarea>
                            </div>
                            <div class="field-row">
                                <div class="field-group">
                                    <label for="client-email">Email *</label>
                                    <input type="email" id="client-email" class="field-input required" placeholder="email@exemple.fr" data-section="client" data-subsection="contact">
                                </div>
                                <div class="field-group">
                                    <label for="client-telephone">T√©l√©phone *</label>
                                    <input type="tel" id="client-telephone" class="field-input required" placeholder="06 XX XX XX XX" data-section="client" data-subsection="contact">
                                </div>
                            </div>
                        </div>

                        <!-- Sous-section √ânergie -->
                        <div class="client-subsection">
                            <div class="client-subsection-header">
                                <span class="subsection-icon">‚ö°</span>
                                <span class="subsection-title">R√©f√©rences √ânergie</span>
                                <div class="subsection-progress" id="energie-progress">0/2</div>
                            </div>
                            <div class="field-row">
                                <div class="field-group">
                                    <label for="client-pdl">PDL √©lectricit√©</label>
                                    <input type="text" id="client-pdl" class="field-input" placeholder="14 chiffres PDL" maxlength="14" data-section="client" data-subsection="energie">
                                    <small class="field-help">Point de Livraison √©lectricit√©</small>
                                </div>
                                <div class="field-group">
                                    <label for="client-pce">PCE gaz</label>
                                    <input type="text" id="client-pce" class="field-input" placeholder="14 chiffres PCE" maxlength="14" data-section="client" data-subsection="energie">
                                    <small class="field-help">Point de Comptage et d'Estimation gaz</small>
                                </div>
                            </div>
                        </div>

                        <!-- Sous-section Paiement -->
                        <div class="client-subsection">
                            <div class="client-subsection-header">
                                <span class="subsection-icon">üí≥</span>
                                <span class="subsection-title">Paiement</span>
                                <div class="subsection-progress" id="paiement-progress">0/1</div>
                            </div>
                            <div class="field-group secure-field">
                                <label for="client-iban">IBAN / RIB üîí</label>
                                <input type="text" id="client-iban" class="field-input secure" placeholder="FR76 XXXX XXXX XXXX XXXX XXXX XX" data-section="client" data-subsection="paiement">
                                <small class="secure-note">üîí Informations bancaires s√©curis√©es</small>
                            </div>
                        </div>

                        <!-- R√©sum√© de progression -->
                        <div class="client-summary">
                            <div class="summary-header">
                                <span class="summary-icon">üìä</span>
                                <span class="summary-title">Progression Client</span>
                            </div>
                            <div class="summary-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="client-progress-bar"></div>
                                </div>
                                <div class="progress-text">
                                    <span id="client-progress-text">0/8 champs renseign√©s</span>
                                    <span id="client-progress-percent">0%</span>
                                </div>
                            </div>
                            <div class="summary-validation">
                                <div class="validation-item" id="validation-required">
                                    <span class="validation-icon">‚ö†Ô∏è</span>
                                    <span class="validation-text">Champs obligatoires: 0/5</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Accords Explicites -->
                <div class="section">
                    <div class="section-header">
                        <h3 class="section-title">‚úÖ ACCORDS EXPLICITES</h3>
                        <div class="section-counter" id="accords-counter">0/6</div>
                    </div>
                    
                    <div class="checkbox-list">
                        <label class="checkbox-item obligatoire">
                            <input type="checkbox" id="accord-rgpd" data-section="accords">
                            <span class="checkmark"></span>
                            <span class="item-label">RGPD donn√©es</span>
                            <span class="badge badge-obligatoire">OBLIGATOIRE</span>
                        </label>
                        
                        <label class="checkbox-item obligatoire">
                            <input type="checkbox" id="accord-reseau" data-section="accords">
                            <span class="checkmark"></span>
                            <span class="item-label">Acc√®s r√©seau Enedis/GRDF</span>
                            <span class="badge badge-obligatoire">OBLIGATOIRE</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="accord-voltalis" data-section="accords">
                            <span class="checkmark"></span>
                            <span class="item-label">Voltalis RDV planifi√©</span>
                        </label>
                        
                        <label class="checkbox-item payant">
                            <input type="checkbox" id="accord-axa" data-section="accords" data-payant="true">
                            <span class="checkmark"></span>
                            <span class="item-label">AXA Assistance 6,99‚Ç¨</span>
                            <span class="badge badge-payant">PAYANT</span>
                        </label>
                        
                        <label class="checkbox-item payant">
                            <input type="checkbox" id="accord-carbone" data-section="accords" data-payant="true">
                            <span class="checkmark"></span>
                            <span class="item-label">Compensation Carbone</span>
                            <span class="badge badge-payant">PAYANT</span>
                        </label>
                        
                        <label class="checkbox-item payant">
                            <input type="checkbox" id="accord-mcp" data-section="accords" data-payant="true">
                            <span class="checkmark"></span>
                            <span class="item-label">Mon Conseiller Perso</span>
                            <span class="badge badge-payant">PAYANT</span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 12px; padding: 10px; background: #F8FAFC; border-radius: 6px; text-align: center; font-size: 12px;">
                        <span style="color: #374151;">Services payants: <strong id="services-count" style="color: #0052CC; font-weight: 600;">0</strong>/3</span>
                        <span style="color: #64748B; margin-left: 6px;">(minimum 2 requis)</span>
                    </div>
                </div>

                <!-- Section Services D√©taill√©s -->
                <div class="section">
                    <div class="section-header">
                        <h3 class="section-title">üìä SERVICES D√âTAILL√âS</h3>
                        <div style="font-size: 10px; color: #64748B;">Statut de proposition/vente</div>
                    </div>
                    
                    <div class="service-dropdown-section">
                        <div class="service-dropdown-header">
                            üõ°Ô∏è AXA ASSISTANCE
                        </div>
                        
                        <div class="service-dropdown-row">
                            <div class="dropdown-group">
                                <label class="dropdown-label" for="axa-statut">Statut AXA</label>
                                <select id="axa-statut" class="service-select status-non" onchange="handleServiceStatusChange('axa', this.value)">
                                    <option value="non">‚ùå Non propos√©</option>
                                    <option value="propose">üí¨ Propos√© au client</option>
                                    <option value="vendu">‚úÖ Vendu/Souscrit</option>
                                </select>
                            </div>
                            <div class="dropdown-group">
                                <label class="dropdown-label">Prix fixe</label>
                                <div style="padding: 8px 10px; background: #F8FAFC; border: 2px solid #E2E8F0; border-radius: 6px; font-size: 12px; color: #64748B;">
                                    6,99‚Ç¨/mois
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="service-dropdown-section" style="margin-top: 12px;">
                        <div class="service-dropdown-header">
                            üå± COMPENSATION CARBONE (OFFSET)
                        </div>
                        
                        <div class="service-dropdown-row">
                            <div class="dropdown-group">
                                <label class="dropdown-label" for="offset-statut">Statut Offset</label>
                                <select id="offset-statut" class="service-select status-non" onchange="handleServiceStatusChange('offset', this.value)">
                                    <option value="non">‚ùå Non propos√©</option>
                                    <option value="propose">üí¨ Propos√© au client</option>
                                    <option value="vendu">‚úÖ Vendu/Souscrit</option>
                                </select>
                            </div>
                            <div class="dropdown-group">
                                <label class="dropdown-label" for="offset-palier">Palier Offset</label>
                                <select id="offset-palier" class="service-select" onchange="handleOffsetPalierChange(this.value)" disabled>
                                    <option value="2.99">2,99‚Ç¨ / 2,24t CO‚ÇÇ</option>
                                    <option value="3.99">3,99‚Ç¨ / 2,98t CO‚ÇÇ</option>
                                    <option value="4.99">4,99‚Ç¨ / 3,59t CO‚ÇÇ</option>
                                    <option value="5.99">5,99‚Ç¨ / 4,49t CO‚ÇÇ</option>
                                    <option value="7.50">7,50‚Ç¨ / 5,40t CO‚ÇÇ</option>
                                    <option value="14.99">14,99‚Ç¨ / 11,34t CO‚ÇÇ</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Groupe palier (masqu√© par d√©faut) -->
                        <div class="offset-palier-group">
                            <div class="palier-info">
                                2,99‚Ç¨/mois - 2,24t CO‚ÇÇ/mois
                            </div>
                        </div>
                    </div>
                    
                    <!-- R√©sum√© des services -->
                    <div style="margin-top: 16px; padding: 12px; background: linear-gradient(135deg, #F0FDF4 0%, #ECFDF5 100%); border: 1px solid #BBF7D0; border-radius: 8px;">
                        <div style="font-size: 12px; font-weight: 600; color: #166534; margin-bottom: 6px;">
                            üìà R√©sum√© Commercial
                        </div>
                        <div style="font-size: 11px; color: #065F46;">
                            Services vendus: <strong id="services-vendus-count">0</strong> | 
                            Services propos√©s: <strong id="services-proposes-count">0</strong>
                            <br>
                            <span style="color: #059669;">Objectif: 2 services vendus minimum</span>
                        </div>
                    </div>
                </div>

                <!-- Section Mentions L√©gales -->
                <div class="section">
                    <div class="section-header">
                        <h3 class="section-title">‚öñÔ∏è MENTIONS L√âGALES</h3>
                        <div class="section-counter" id="mentions-counter">0/5</div>
                    </div>
                    
                    <div class="checkbox-list">
                        <label class="checkbox-item">
                            <input type="checkbox" id="mention-axa-exclusions" data-section="mentions">
                            <span class="checkmark"></span>
                            <span class="item-label">AXA 4 exclusions</span>
                            <span class="badge badge-timer">30s min</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="mention-axa-rgpd" data-section="mentions">
                            <span class="checkmark"></span>
                            <span class="item-label">AXA RGPD + dur√©e</span>
                            <span class="badge badge-timer">20s min</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="mention-carbone" data-section="mentions">
                            <span class="checkmark"></span>
                            <span class="item-label">Carbone processus</span>
                            <span class="badge badge-timer">15s min</span>
                        </label>
                        
                        <label class="checkbox-item obligatoire">
                            <input type="checkbox" id="mention-frais" data-section="mentions">
                            <span class="checkmark"></span>
                            <span class="item-label">Frais MES communiqu√©s</span>
                            <span class="badge badge-obligatoire">OBLIGATOIRE</span>
                        </label>
                        
                        <label class="checkbox-item obligatoire">
                            <input type="checkbox" id="mention-retractation" data-section="mentions">
                            <span class="checkmark"></span>
                            <span class="item-label">D√©lai r√©tractation 14j</span>
                            <span class="badge badge-obligatoire">OBLIGATOIRE</span>
                        </label>
                    </div>
                </div>

                <!-- Section Signatures SMS -->
                <div class="section">
                    <div class="section-header">
                        <h3 class="section-title">üì± SIGNATURES SMS</h3>
                        <div class="section-counter" id="sms-counter">0/3</div>
                    </div>
                    
                    <div class="checkbox-list">
                        <label class="checkbox-item">
                            <input type="checkbox" id="sms-axa" data-section="sms">
                            <span class="checkmark"></span>
                            <span class="item-label">Code AXA re√ßu/valid√©</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="sms-carbone" data-section="sms">
                            <span class="checkmark"></span>
                            <span class="item-label">Code Carbone re√ßu/valid√©</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="sms-mcp" data-section="sms">
                            <span class="checkmark"></span>
                            <span class="item-label">Code MCP re√ßu/valid√©</span>
                        </label>
                    </div>
                </div>

                <!-- Section √âtapes Commerciales -->
                <div class="section">
                    <div class="section-header">
                        <h3 class="section-title">üéØ √âTAPES COMMERCIALES</h3>
                        <div class="section-counter" id="etapes-counter">0/7</div>
                    </div>
                    
                    <div class="checkbox-list">
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-qualification" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">Client qualifi√© correctement</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-besoins" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">Besoins analys√©s</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-offre" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">Offre pr√©sent√©e clairement</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-objections" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">Objections trait√©es</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-addons" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">Add-ons propos√©s (min 2 payants)</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-signatures" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">Signatures obtenues</span>
                        </label>
                        
                        <label class="checkbox-item">
                            <input type="checkbox" id="etape-recap" data-section="etapes">
                            <span class="checkmark"></span>
                            <span class="item-label">R√©cap final effectu√©</span>
                        </label>
                    </div>
                </div>

                <!-- Actions finales -->
                <div class="final-actions">
                    <button class="action-btn validate-btn" id="validate-btn" onclick="openValidationModal()" disabled>
                        ‚ö†Ô∏è 0 crit√®re(s) manquant(s)
                    </button>
                    <button class="action-btn reset-btn" onclick="resetChecklist()">
                        üîÑ Reset
                    </button>
                </div>
            </div>

            <!-- TAB 2: HISTORIQUE -->
            <div id="tab-history-content" class="tab-content">
                <div class="history-container">
                    <div class="history-header">
                        <h3 class="history-title">üìä Historique des Ventes</h3>
                        <div class="history-stats">
                            <div class="history-stat">
                                <span>üìà Total:</span>
                                <strong id="total-sales">0</strong>
                            </div>
                            <div class="history-stat">
                                <span>‚≠ê Services:</span>
                                <strong id="total-services">0</strong>
                            </div>
                        </div>
                        <button class="clear-history-btn" onclick="clearHistory()">üóëÔ∏è Vider</button>
                    </div>
                    
                    <div class="history-list" id="history-list">
                        <div class="history-empty">
                            <div class="history-empty-icon">üìã</div>
                            <p>Aucune vente enregistr√©e</p>
                            <small>Les ventes valid√©es appara√Ætront ici</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Validation -->
        <div id="validation-modal" class="validation-modal">
            <div class="validation-content">
                <div class="validation-header">
                    <h3>üéØ Validation de la Vente</h3>
                    <p>V√©rifiez tous les √©l√©ments avant enregistrement</p>
                </div>
                
                <div class="validation-body">
                    <div class="validation-section">
                        <h4>üìù Informations Client</h4>
                        <div id="validation-client"></div>
                    </div>
                    
                    <div class="validation-section">
                        <h4>‚úÖ Accords & Services</h4>
                        <div id="validation-accords"></div>
                    </div>
                    
                    <div class="validation-section">
                        <h4>‚öñÔ∏è Conformit√©</h4>
                        <div id="validation-conformite"></div>
                    </div>
                </div>
                
                <div class="validation-actions">
                    <button class="validation-btn validation-btn-cancel" onclick="closeValidationModal()">
                        Annuler
                    </button>
                    <button class="validation-btn validation-btn-save" id="validation-save-btn" onclick="saveToHistory()" disabled>
                        üíæ Enregistrer Vente
                    </button>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div id="notification" class="notification" style="display: none;"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>